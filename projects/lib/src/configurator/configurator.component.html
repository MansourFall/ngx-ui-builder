<div #offcanvas class="offcanvas offcanvas-end" tabindex="-1" id="offcanvas" *ngIf="{edited: (edited$ | async)} as obs">
  <!-- HEADER -->
  <div class="offcanvas-header bg-light border-bottom">
    <h5 class="offcanvas-title" *ngIf="!_showTree && obs.edited">
      <strong>{{obs.edited.config.id}}</strong>
      <br/>
      <h6>(Type: <strong>{{obs.edited.config.type}}</strong>)</h6>
    </h5>
    <h5 class="offcanvas-title" *ngIf="_showTree">Configuration Tree</h5>

    <button type="button" class="btn ms-auto" [ngClass]="_showTree? 'btn-secondary' : 'btn-light'" uib-tooltip="{{_showTree? 'Hide' : 'Show'}} configuration tree" (click)="showTree(!_showTree)">
      <svg-icon key="tree" width="22px" height="25px"></svg-icon>
    </button>
    <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <div class="offcanvas-body">

    <div class="d-flex justify-content-start mb-1" *ngIf="obs?.edited?.context.parentId">
      <button class="btn btn-outline-danger" (click)="remove(obs.edited, $event)">Remove</button>
    </div>
    
    <ng-container *ngIf="!_showTree && obs.edited">
      <!-- CONFIGURATOR -->
    
      <ng-container
        *ngTemplateOutlet="configurators[obs.edited.config.type]; context: { $implicit: obs.edited }">
      </ng-container>
  
      <hr *ngIf="configurators[obs.edited.config.type]"/>
  
      <details *ngIf="obs.edited.config.type === 'container'" open>
        <summary>Layout</summary>
        <uib-flex-editor [config]="obs.edited.config"></uib-flex-editor>
      </details>
  
      <uib-class-editor [config]="obs.edited.config" *ngIf="cssClasses"></uib-class-editor>
  
      <details [attr.open]="obs.edited.config.condition? '' : undefined" *ngIf="conditionalDisplay && obs.edited.context.data">
        <summary uib-tooltip="Display this component only if the data validates a rule">Conditional display</summary>
        <uib-condition-editor [config]="obs.edited.config"></uib-condition-editor>
      </details>
    </ng-container>
    
    <uib-tree [configuration]="configuration" *ngIf="_showTree"></uib-tree>
      
  </div>
</div>
