<ng-container
  *ngTemplateOutlet="isArray ? array : single; context: { $implicit: data }"
>
</ng-container>

<!-- data is an array -->
<ng-template #array let-data>
  <ng-container *ngFor="let d of data; let i = index">
    <ng-container
      *ngTemplateOutlet="single; context: { $implicit: d, index: i }"
    >
    </ng-container>
  </ng-container>
</ng-template>

<!-- data is a single object -->
<ng-template #single let-data let-index="index">
  <div #ref

    uib-configurable    
    [uib-disable-if]="index"

    [uib-item]="id"
    [id]="id"
    [zone]="id"
    [templates]="templates"
    [enableContainers]="enableContainers"

    [data]="data"
    [dataIndex]="index"

    [dndDropzone]="[id]"
    [dndHorizontal]="ref.isHorizontal()"
    [dndDisableDropIf]="index"
    (dndDrop)="onDndDrop($event)"
  ></div>
</ng-template>
